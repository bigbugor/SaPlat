<!doctype html>
<html lang="zh">

<style>
    .buttonChange {
        background: #66bab7;
    }
</style>
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel='stylesheet prefetch' href='/static/css/PilotStyle/reset.css'>
    <link rel="stylesheet" type="text/css" href="/static/css/PilotStyle/default.css">
    <link rel="stylesheet" type="text/css" href="/static/css/PilotStyle/styles.css">
    <script src="/static/js/pilotJS/jquery-2.1.1.min.js"></script>
    <script src="/static/js/pilotJS/jquery.easing.min.js" type="text/javascript"></script>
</head>

<body>
<article class="htmleaf-content">
    <form id="msform" class="layui-form x-center" method='post'>
        <ul id="progressbar">
            <li class="active">项目主体资料填写</li>
            <li>稳评领导小组资料填写</li>
            <li>自评/委评</li>
            <li>保存提交</li>
        </ul>

        <fieldset>
            <h1 class="fs-title">请填写项目相关资料</h1>

            <div>
                <label for="project.name">项目名称</label>
                <input type="text" id="project.name" name="project.name"/>
            </div>

            <div>
                <label for="project.roleName">角色名称</label>
                <select id="project.roleName" name="project.roleName">
                    #for(List : roleNameList)
                    <option>#(List)</option>
                    #end
                </select>
            </div>

            <div>
                <label for="project.amount">预计金额</label>
                <input type="number" id="project.amount" name="project.amount"/>
            </div>

            <div>
                <label for="project.paTypeID">项目评估类型</label>
                <select id="project.paTypeID" name="project.paTypeID">
                    #for(List : PaTypeNameList)
                    <option value="#(List.id)">#(List.name)</option>
                    #end
                </select>
            </div>

            <div>
                <label for="project.pStepID">项目阶段</label>
                <select id="project.pStepID" name="project.pStepID">
                    #for(List : projectStepNameList)
                    <option value="#(List.id)">#(List.name)</option>
                    #end
                </select>
            </div>

            <div>
                <label for="project.site">地址</label>
                <input type="text" id="project.site" name="project.site"/>
            </div>

            <div>
                <label for="project.brief">简介</label>
                <input type="text" id="project.brief" name="project.brief"/>
            </div>

            <div>
                <label class="layui-form-label" for="project.approval">相关批文</label>
                <input type="text" id="project.approval" name="project.approval"/>
            </div>

            <div>
                <label class="layui-form-label" for="project.proposal">建议书</label>
                <input type="text" id="project.proposal" name="project.proposal"/>
            </div>
            <input type="button" name="next" class="next action-button" value="下一步"/>
        </fieldset>

        <fieldset>
            <h1 class="fs-title">请填写领导小组相关资料</h1>
            <div>
                <label for="leaderGroup.name">小组名称</label>
                <input type="text" id="leaderGroup.name" name="leaderGroup.name"/>
            </div>
            <div>
                <label for="LeaderGroup.leader">组长</label>
                <input type="text" id="leaderGroup.leader" name="leaderGroup.leader"/>
            </div>
            <div>
                <label for="LeaderGroup.deputy">副组长</label>
                <input type="text" id="leaderGroup.deputy" name="leaderGroup.deputy"/>
            </div>
            <div>
                <label for="LeaderGroup.crew">组员</label>
                <input type="text" id="leaderGroup.crew" name="leaderGroup.crew"/>
            </div>
            <input type="button" name="previous" class="previous action-button" value="上一步"/>
            <input type="button" name="next" class="next action-button" value="下一步"/>
        </fieldset>

        <fieldset>
            <h1 class="fs-title">请选择评估方式</h1>
            <input type="button" id="selfAssessment" value="自评"/>
            <input type="button" id="othersAssessment" value="委评"/>
            <input type="button" name="previous" class="previous action-button" value="上一步"/>
            <input type="button" name="next" class="next action-button" value="下一步"/>
        </fieldset>

        <fieldset>
            <h1 class="fs-title">是否确认提交？</h1>
            <input type="button" name="previous" class="previous action-button" value="上一步"/>
            <input type="submit" name="submit" id="submit" class="submit action-button" value="提交"/>
        </fieldset>
    </form>
</article>

<script>
    var current_fs, next_fs, previous_fs;
    var left, opacity, scale;
    var animating;
    /**
     * 下一步按钮事件
     */
    $('.next').click(function () {
        if (animating)
            return false;
        animating = true;
        current_fs = $(this).parent();
        next_fs = $(this).parent().next();
        $('#progressbar li').eq($('fieldset').index(next_fs)).addClass('active');
        next_fs.show();
        current_fs.animate({opacity: 0}, {
            step: function (now, mx) {
                scale = 1 - (1 - now) * 0.2;
                left = now * 50 + '%';
                opacity = 1 - now;
                current_fs.css({'transform': 'scale(' + scale + ')'});
                next_fs.css({
                    'left': left,
                    'opacity': opacity
                });
            },
            duration: 800,
            complete: function () {
                current_fs.hide();
                animating = false;
            },
            easing: 'easeInOutBack'
        });
    });

    /**
     * 上一步按钮事件
     */
    $('.previous').click(function () {
        if (animating)
            return false;
        animating = true;
        current_fs = $(this).parent();
        previous_fs = $(this).parent().prev();
        $('#progressbar li').eq($('fieldset').index(current_fs)).removeClass('active');
        previous_fs.show();
        current_fs.animate({opacity: 0}, {
            step: function (now, mx) {
                scale = 0.8 + (1 - now) * 0.2;
                left = (1 - now) * 50 + '%';
                opacity = 1 - now;
                current_fs.css({'left': left});
                previous_fs.css({
                    'transform': 'scale(' + scale + ')',
                    'opacity': opacity
                });
            },
            duration: 800,
            complete: function () {
                current_fs.hide();
                animating = false;
            },
            easing: 'easeInOutBack'
        });
    });

    /**
     * 自评按钮事件
     */
    $('#selfAssessment').click(function () {
        $('#selfAssessment').attr("name", "project.assessmentMode");
        $('#selfAssessment').addClass("buttonChange");
        $('#othersAssessment').removeClass("buttonChange");
        $('#othersAssessment').attr("name", null);
    });

    /**
     * 委评按钮事件
     */
    $('#othersAssessment').click(function () {
        $('#othersAssessment').attr("name", "project.assessmentMode");
        $('#othersAssessment').addClass("buttonChange");
        $('#selfAssessment').removeClass("buttonChange");
        $('#selfAssessment').attr("name", null);
    });

    /**
     * 数据的手动打包
     */
    function parame() {
        var string = "?";
        var valueArray = new Array();
        var nameArray = new Array();
        $("input").each(function (key) {
            valueArray[key] = $(this).val();
            nameArray[key] = $(this).attr('name');
            string += nameArray[key] + "=" + valueArray[key] + "&";
        });
        $("select").each(function () {
            string += $(this).attr('name') + "=" + $(this).val() + "&";
        });
        return string;
    }

    /**
     * 提交按钮事件
     */
    $('#submit').click(function () {
        if ($('#selfAssessment').attr('name') == null) {
            var url = "#(ctxPath)/app/project/othersAssessment";
            window.location.href = url + parame();
        } else if ($('#othersAssessment').attr('name') == null) {
            var url = "#(ctxPath)/app/project/selfAssessment";
            window.location.href = url + parame();
        }
        return false;
    });
</script>
</body>
</html>