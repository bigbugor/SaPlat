#include("/template/common/layout/_page_layout.html")
#@layout()

#define css()
<style>
    .layui-input-inline p {
        text-align: center;
        line-height: 3;
    }
</style>
#end

#define js()
<script type="text/javascript">
    layui.use(['form', 'layer', 'element'], function () {
        var layer = layui.layer
            , $ = layui.jquery
            , form = layui.form
            , element = layui.element;

        form.val("formTest", {
            "affectedGroup.occupation": $('#occupationSelected').val()
            , "affectedGroup.duty": $('#dutySelected').val()
            , "affectedGroup.politics": $('#politicsSelected').val()
            , "affectedGroup.nation": $('#nationSelected').val()
            , "affectedGroup.education": $('#educationSelected').val()
            , "affectedGroup.nationality": $('#nationalitySelected').val()
        });

        form.on('submit(sub)', function (data) {
            util.sendAjax({
                type: 'POST',
                url: '#(ctxPath)/app/person/postUpdate',
                data: $('#person').serialize(),
                loadFlag: true,
                success: function (data) {
                    layer.msg('编辑成功');
                    $(".layui-btn").addClass("layui-hide");
                    $("#perfect").removeClass("layui-hide");
                    $(":input").addClass("layui-disabled").prop("disabled", "disabled");
                    setTimeout(function () {
                        return true;
                    }, 3000);
                },
                error: function (data) {
                    console.log(data);
                }
            });
            return false;
        });


        $('#reset').click(function () {
            history.go(-1);
        });


        $(".layui-btn").addClass("layui-hide");
        $(":input").addClass("layui-disabled").prop("disabled", "disabled");
        $('#perfect').click(function () {
            $(":input[disabled='disabled']").removeClass("layui-disabled").removeProp("disabled");
            $(".layui-btn").removeClass("layui-hide");
            $(this).addClass("layui-hide");
            return false;
        }).removeClass("layui-hide").removeClass("layui-disabled").prop("disabled", "");

        // $(".layui-select-title").unbind();

        form.verify({
            duty: function (value, item) {
                if (value === "" || value.trim() === "") {
                    return "请选择 工作信息 - 职务"
                }
            },
            occupation: function (value, item) {
                if (value === "" || value.trim() === "") {
                    return "请选择 工作信息 - 职业"
                }
            }
        });
    });
</script>
#end

#define content()
<div class="layui-fluid">
    <fieldset class="layui-elem-field layui-field-title" style="margin-top: 50px;">
        <legend>个人资料</legend>
    </fieldset>


    <form id="person" class="layui-form x-center" action="" lay-filter="formTest">
        <div class="layui-form-pane">
            <div class="layui-tab layui-tab-brief" lay-filter="docDemoTabBrief">
                <ul class="layui-tab-title">
                    <li class="layui-this">个人资料</li>
                    <li>联系方式</li>
                    <li>工作信息</li>
                    <li>家庭信息</li>
                </ul>
                <div class="layui-tab-content">
                    <div class="layui-tab-item layui-show">

                        <div class="layui-form-item">
                            <label class="layui-form-label">账号(名称)</label>
                            <div class="layui-input-inline">
                                <p>#(user.name)</p>
                            </div>
                        </div>
                        <div class="layui-form-item">
                            <label class="layui-form-label">用户姓名</label>
                            <div class="layui-input-inline">
                                <p>#(person.name)</p>
                            </div>
                        </div>
                        <div class="layui-form-item">
                            <label class="layui-form-label" for="affectedGroup.othername">曾用名</label>
                            <div class="layui-input-inline">
                                <input type="text" id="affectedGroup.othername" name="affectedGroup.othername"
                                       value="#(affectedGroup.othername)" class="layui-input"/>
                            </div>
                        </div>
                        <div class="layui-form-item">
                            <label class="layui-form-label">性别</label>
                            <div class="layui-input-inline">
                                <p>#(person.sex)</p>
                            </div>
                        </div>
                        <div class="layui-form-item">
                            <label class="layui-form-label" for="affectedGroup.birthday"><em
                                    class="require-mark">*</em>出生日期</label>
                            <div class="layui-input-inline">
                                <input type="date" id="affectedGroup.birthday" name="affectedGroup.birthday"
                                       value="#(affectedGroup.birthday)"
                                       lay-verify="date"
                                       placeholder="yyyy-MM-dd" autocomplete="off" class="layui-input" required/>
                            </div>
                        </div>
                        <div class="layui-form-item">
                            <label class="layui-form-label" for="affectedGroup.nationality"><em
                                    class="require-mark">*</em>国籍</label>
                            <div class="layui-input-inline">
                                <input type="hidden" id="nationalitySelected" name="nationalitySelected"
                                       value="#(affectedGroup.nationalityID)"/>
                                <select id="affectedGroup.nationality" name="affectedGroup.nationalityID"
                                        lay-verify="required">
                                    #if(thisCountry != null)
                                    <option value="#(thisCountry.id)" selected>#(thisCountry.name)</option>
                                    #else
                                    <option value=""></option>
                                    #end
                                    #statusOption(contryStatus);
                                </select>
                            </div>
                        </div>
                        <div class="layui-form-item">
                            <label class="layui-form-label" for="affectedGroup.nation"><em
                                    class="require-mark">*</em>民族</label>
                            <div class="layui-input-inline">
                                <input type="hidden" id="nationSelected" name="nationSelected"
                                       value="#(affectedGroup.nationID)"/>
                                <select id="affectedGroup.nation" name="affectedGroup.nationID" lay-verify="required">
                                    #if(thisNation != null)
                                    <option value="#(thisNation.id)" selected>#(thisNation.name)</option>
                                    #else
                                    <option value=""></option>
                                    #end
                                    #statusOption(nationStatus);
                                </select>
                            </div>
                        </div>
                        <div class="layui-form-item">
                            <label class="layui-form-label" for="affectedGroup.politics"><em
                                    class="require-mark">*</em>政治面貌</label>
                            <div class="layui-input-inline">
                                <input type="hidden" id="politicsSelected" name="politicsSelected"
                                       value="#(affectedGroup.politicsID)"/>
                                <select id="affectedGroup.politics" name="affectedGroup.politicsID"
                                        lay-verify="required">
                                    #if(thisPolitical != null)
                                    <option value="#(thisPolitical.id)" selected>#(thisPolitical.name)</option>
                                    #else
                                    <option value=""></option>
                                    #end
                                    #statusOption(politicalOpts);
                                </select>
                            </div>
                        </div>
                        <div class="layui-form-item">
                            <label class="layui-form-label" for="affectedGroup.education"><em
                                    class="require-mark">*</em>学历</label>
                            <div class="layui-input-inline">
                                <input type="hidden" id="educationSelected" name="educationSelected"
                                       value="#(affectedGroup.educationID)"/>
                                <select id="affectedGroup.education" name="affectedGroup.educationID"
                                        lay-verify="required">
                                    #if(thisEducational != null)
                                    <option value="#(thisEducational.id)" selected>#(thisEducational.name)</option>
                                    #else
                                    <option value=""></option>
                                    #end
                                    #statusOption(educationalStatus);
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="layui-tab-item">
                        <div class="layui-form-item">
                            <label class="layui-form-label"><em
                                    class="require-mark">*</em>电话号码</label>
                            <div class="layui-input-inline">
                                <input value="#(user.phone)" class="layui-input layui-disabled" disabled>
                            </div>
                        </div>
                        <div class="layui-form-item">
                            <label class="layui-form-label">邮箱</label>
                            <div class="layui-input-inline">
                                <p>#(user.email)</p>
                            </div>
                        </div>
                        <div class="layui-form-item">
                            <label class="layui-form-label" for="affectedGroup.residence"><em
                                    class="require-mark">*</em>长期居住地址</label>
                            <div class="layui-input-inline">
                                <input type="text" id="affectedGroup.residence" name="affectedGroup.residence"
                                       value="#(affectedGroup.residence)" class="layui-input" required/>
                            </div>
                        </div>
                    </div>
                    <div class="layui-tab-item">
                        <div class="layui-form-item">
                            <label class="layui-form-label" for="affectedGroup.occupation">职业</label>
                            <div class="layui-input-inline">
                                <select id="affectedGroup.occupation" name="affectedGroup.occupation"
                                        lay-verify="occupation">
                                    <option value=""></option>
                                    #if(thisOccupation != null)
                                    <option value="#(thisOccupation.id)" selected>#(thisOccupation.name)</option>
                                    occupation
                                    #end
                                    #statusOption(occupationOpts);
                                </select>
                            </div>
                        </div>
                        <div class="layui-form-item">
                            <label class="layui-form-label" for="affectedGroup.duty">职务</label>
                            <div class="layui-input-inline">
                                <select id="affectedGroup.duty" name="affectedGroup.dutyID"
                                        lay-verify="duty">
                                    <option value=""></option>
                                    #if(thisPost != null)
                                    <option value="#(thisPost.id)" selected>#(thisPost.name)</option>
                                    #end
                                    #statusOption(postStatus);
                                </select>
                            </div>
                        </div>
                        <div class="layui-form-item layui-form-text">
                            <label class="layui-form-label" for="affectedGroup.resume">工作简历</label>
                            <div class="layui-input-block">
                            <textarea id="affectedGroup.resume" name="affectedGroup.resume"
                                      placeholder="请输入内容" class="layui-textarea"></textarea>
                            </div>
                        </div>
                    </div>
                    <div class="layui-tab-item">
                        <div class="layui-form-item">
                            <label class="layui-form-label" for="affectedGroup.census">户籍</label>
                            <div class="layui-input-inline">
                                <input type="text" id="affectedGroup.census" name="affectedGroup.census"
                                       value="#(affectedGroup.census)" class="layui-input"/>
                            </div>
                        </div>
                        <div class="layui-form-item">
                            <label class="layui-form-label" for="affectedGroup.maritalstatus">婚姻状况</label>
                            <div class="layui-input-block" id="affectedGroup.maritalstatus">
                                <input type="radio" name="affectedGroup.maritalstatus" value="已婚" title="已婚">
                                <input type="radio" name="affectedGroup.maritalstatus" value="未婚" title="未婚" checked>
                            </div>
                        </div>
                        <div class="layui-form-item">
                            <label class="layui-form-label" for="affectedGroup.children">子女情况</label>
                            <div class="layui-input-inline">
                                <input type="text" id="affectedGroup.children" name="affectedGroup.children"
                                       value="#(affectedGroup.children)" class="layui-input"/>
                            </div>
                        </div>
                    </div>
                </div>
            </div>


            <div class="layui-form-item">
                <div class="layui-input-block">
                    <button class="layui-btn layui-hide" lay-submit lay-filter="sub">立即提交</button>
                    <button class="layui-btn layui-btn-warm layui-hide" id="reset">取消</button>
                    <button class="layui-btn layui-btn-normal" id="perfect">完善资料</button>
                </div>
            </div>
        </div>
    </form>
    <hr>
</div>

#end